import{$ as x,c as h,a as $}from"./mixins-CCcJzSNR.js";import{_ as U}from"./DialogCloseBtn-BdxeNjKC.js";import{ax as j,H as I,ay as L,Y as p,r as A,a as E,c as _,o as k,b as l,e as n,d as a,v as r,m as s,t,a1 as H,f as q,l as F,F as G,h as J,a3 as Y}from"./main-DMixy-zA.js";import{S as z}from"./sweetalert2-z6gKu1nJ.js";import{u as O}from"./useApi-BFo9Fwth.js";import{c as W}from"./createUrl-BGpqzwGy.js";import{$ as Q}from"./api-DuTb8U9y.js";import{a as w,V}from"./VRow-ldvFrort.js";import{V as y}from"./VCard-BL5sBgqt.js";import{V as K}from"./VTable-dHB6tNEb.js";import{V as S}from"./VCardText-COsGQpPl.js";import{V as N}from"./VAlert-BDsNoO6o.js";import{V as X}from"./VDialog-BlKjDFXC.js";import"./index-9rIf2CJL.js";/* empty css              */import"./VAvatar-Bum6FSQ0.js";import"./VImg-CVtU7sDy.js";import"./VOverlay-BQWTyvUN.js";import"./forwardRefs-DWGaNmQL.js";const Z={width:"60%"},aa={class:"text-white"},ea={class:"text-center"},ta={class:"text-center"},la={key:1},na={class:"text-center"},Ca={__name:"erapor",async setup(sa){let g,b;j({title:`Kirim Data e-Rapor | ${I.app.title}`});const{data:u,execute:T}=([g,b]=L(()=>O(W("/sinkronisasi/erapor",{query:{sekolah_id:h.sekolah_id,semester_id:$.semester_id,user_id:h.user_id}}))),g=await g,b(),g),B=p(()=>u.value.last_sync),P=p(()=>u.value.table_sync),f=p(()=>u.value.jumlah),v=p(()=>{var o;return(o=u.value.response)==null?void 0:o.error}),R=p(()=>{var o;return(o=u.value.response)==null?void 0:o.message}),i=A(!1);f.value>1e3&&(i.value=!0);const c=A(!1),M=async()=>{c.value=!0,await Q("/sinkronisasi/kirim-data",{method:"POST",body:{sekolah_id:h.sekolah_id,semester_id:$.semester_id,user_id:h.user_id},onResponse({request:o,response:e,options:C}){let m=e._data;c.value=!1,z.fire({icon:m.icon,title:m.title,text:m.text}).then(d=>{T()})}})};return(o,e)=>{const C=E("font-awesome-icon"),m=U;return k(),_("div",null,[l(V,null,{default:n(()=>[l(w,{cols:"6",xl:"8",md:"8",sm:"6"},{default:n(()=>[l(y,null,{default:n(()=>[l(K,{class:"text-no-wrap"},{default:n(()=>[a("tbody",null,[a("tr",null,[e[2]||(e[2]=a("td",{rowspan:"3",width:"10%",style:{"border-right":"1px solid #dddddd"}},[a("img",{src:"/images/logo/logo-small.png",alt:"Logo e-Rapor SMK",style:{"max-width":"100px"}})],-1)),e[3]||(e[3]=a("td",{width:"30%"},"   NPSN Sekolah",-1)),a("td",Z,r(("$sekolah"in o?o.$sekolah:s(x)).npsn),1)]),a("tr",null,[e[4]||(e[4]=a("td",null,"Nama Sekolah",-1)),a("td",null,r(("$sekolah"in o?o.$sekolah:s(x)).alamat),1)]),a("tr",null,[e[5]||(e[5]=a("td",null,"Desa Kelurahan Sekolah",-1)),a("td",null,r(("$sekolah"in o?o.$sekolah:s(x)).desa_kelurahan),1)])])]),_:1})]),_:1})]),_:1}),l(w,{cols:"6",xl:"4",md:"4",sm:"6"},{default:n(()=>[l(y,null,{default:n(()=>[l(S,{class:"text-center"},{default:n(()=>[a("p",null,[e[6]||(e[6]=t("Pengiriman data terakhir dilakukan pada ")),e[7]||(e[7]=a("br",null,null,-1)),a("strong",null,r(s(B)),1)]),l(H,{loading:s(c),disabled:s(c)||s(v)||!s(f),size:"large",color:"success",onClick:M},{default:n(()=>[l(C,{icon:"fa-solid fa-cloud-arrow-up"}),e[8]||(e[8]=t("   ")),e[9]||(e[9]=a("strong",null,"KIRIM DATA",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),l(V,null,{default:n(()=>[l(w,{cols:"12"},{default:n(()=>[l(N,{color:"secondary",class:"text-center"},{default:n(()=>e[10]||(e[10]=[a("h3",{class:"text-white"},"DATA YANG MENGALAMI PERUBAHAN",-1)])),_:1}),s(v)?(k(),q(N,{key:0,color:"error",class:"text-center mt-4"},{default:n(()=>[a("h3",aa,r(s(R)),1)]),_:1})):F("",!0)]),_:1})]),_:1}),l(V,null,{default:n(()=>[l(w,{cols:"12"},{default:n(()=>[l(y,null,{default:n(()=>[l(K,{class:"text-no-wrap"},{default:n(()=>[e[13]||(e[13]=a("thead",null,[a("tr",null,[a("th",{class:"text-center",width:"5%"},"No"),a("th",{width:"80%"},"Data"),a("th",{class:"text-center",width:"15%"},"Jml Data")])],-1)),a("tbody",null,[s(f)?(k(!0),_(G,{key:0},J(s(P),(d,D)=>(k(),_("tr",{key:D},[a("td",ea,r(D+1),1),a("td",null,r(d.data),1),a("td",ta,r(d.count),1)]))),128)):(k(),_("tr",la,e[11]||(e[11]=[a("td",{colspan:"3",class:"text-center"},"Tidak ada data yang mengalami perubahan",-1)])))]),a("tfoot",null,[a("tr",null,[e[12]||(e[12]=a("th",{colspan:"2",class:"text-right"},"Jumlah",-1)),a("th",na,r(s(f)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),l(X,{modelValue:s(i),"onUpdate:modelValue":e[1]||(e[1]=d=>Y(i)?i.value=d:null),width:"800"},{default:n(()=>[l(m,{onClick:e[0]||(e[0]=d=>i.value=!s(i))}),l(y,{title:"Informasi"},{default:n(()=>[l(S,null,{default:n(()=>e[14]||(e[14]=[a("p",null,[t("Terdeteksi jumlah data yang akan dikirim melebihi 1.000 row. Sangat disarankan melakukan pengiriman data melalui "),a("code",null,"Command Prompt"),t(" untuk menghindari kegagalan pengiriman data.")],-1),a("p",null,[t("Cara melakukan pengiriman data melalui "),a("code",null,"Command Prompt"),t(":")],-1),a("p",null,[t("Untuk Pengguna "),a("strong",null,"Windows")],-1),a("ol",{style:{"padding-left":"20px"}},[a("li",null,"Buka CMD"),a("li",null,[t("Ketik: "),a("code",null,"cd c:\\eRaporSMK\\dataweb"),t(" [enter]")]),a("li",null,[t("Ketik: "),a("code",null,"php artisan kirim:erapor"),t(" [enter]")]),a("li",null,"Ketikkan email administrator"),a("li",null,"Tunggu hingga proses pengiriman data selesai.")],-1),a("p",null,[t("Untuk Pengguna "),a("strong",null,"Linux")],-1),a("ol",{style:{"padding-left":"20px"}},[a("li",null,[t("Buka Aplikasi Putty dan login ke "),a("code",null,"shh")]),a("li",null,[t("Ketik: "),a("code",null,[t("cd /var/www/html/dataweb"),a("sup",null,"*")]),t(" [enter]")]),a("li",null,[t("Ketik: "),a("code",null,"php artisan kirim:erapor"),t(" [enter]")]),a("li",null,"Ketikkan email administrator"),a("li",null,"Tunggu hingga proses pengiriman data selesai.")],-1),a("p",null,[t("Keterangan: "),a("br"),t(" * : Sesuaikan dengan direktori root folder aplikasi e-Rapor SMK di install "),a("br"),t(" Untuk mengirimkan seluruh data yang tersimpan di database tanpa filter apapun, jalankan perintah: "),a("code",null,"php artisan kirim:erapor --force")],-1)])),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Ca as default};
