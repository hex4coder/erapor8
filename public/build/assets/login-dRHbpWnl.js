import{r as I}from"./validators-BHkKs9Dp.js";import{ay as H,H as d,r as n,G as O,c as E,d as o,b as t,m as a,v as V,e as r,F as G,i as K,j as z,a as Y,o as C,t as _,a0 as J,f as Q,l as W,a1 as X,ab as m,az as Z}from"./main-BmaFLECC.js";import{_ as ee}from"./AppSelect-Dodmi1Ge.js";import{_ as ae}from"./AppTextField-D2LXjmv0.js";import{u as P,a as te,b as se}from"./misc-mask-light-DFRoxJPE.js";import{a as R,l as A}from"./index-DmeuT8qN.js";import{u as oe}from"./useAbility-DwY4ildr.js";import{$ as re}from"./api-CmLymv6O.js";import{u as le}from"./useApi-aDZ_p2JA.js";import{c as ie}from"./createUrl-CavU1t8i.js";import{V as D,a as p}from"./VRow-C3UxGzeT.js";import{V as ne}from"./VImg-60m1FPF8.js";import{V as me}from"./VCard-DPBtMZW7.js";import{V as v}from"./VCardText-D2uK2Y8d.js";import{V as ue}from"./VForm-DpvbJd19.js";import{V as de}from"./VCheckbox-FIE6UM22.js";import"./VLabel-Dun9QuG8.js";import"./VTextField-DU5I-02O.js";import"./forwardRefs-DWGaNmQL.js";import"./VList--zc2cV7Y.js";import"./VAvatar-DzKqRnSB.js";import"./VDivider-BN4YXaja.js";import"./VOverlay-DrobohEp.js";import"./VMenu-uYX0kftc.js";import"./VSelectionControl-C32W22li.js";import"./VChip-DASL0bCx.js";import"./index-9rIf2CJL.js";/* empty css              */const pe="/build/assets/auth-v2-login-illustration-bordered-dark-cDkPk8mY.png",ce="/build/assets/auth-v2-login-illustration-bordered-light-CIHqcIVA.png",fe={href:"javascript:void(0)"},ge={class:"auth-logo d-flex align-center gap-x-3"},he=["src"],Ve={class:"auth-title"},_e={class:"position-relative bg-background w-100 me-0"},ve={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},be=["src"],ke={class:"text-h2 mb-1"},ye=["src"],we={class:"d-flex align-center flex-wrap justify-space-between my-6"},Ze={__name:"login",setup(xe){const L=P(R,R,ce,pe,!0),N=P(se,te);H({title:`Login | ${d.app.title}`});const b=n(),l=n({email:"",password:"",semester_id:"",remember:!1}),k=K(),j=z(),q=oe(),f=n({email:void 0,password:void 0}),c=n(!1),y=n([]),w=n(""),B=()=>{A(`<strong>Selamat Datang ${w.value}</strong>
    <br>Anda telah berhasil masuk sebagai <strong>${y.value}</strong>. Sekarang Anda dapat mulai berselancar di Aplikasi e-Rapor SMK!`,{closeOnClick:!1,autoClose:5e3,position:A.POSITION.TOP_RIGHT,dangerouslyHTMLString:!0})},U=async()=>{try{const s=await re("/auth/login",{method:"POST",body:{email:l.value.email,password:l.value.password,semester_id:l.value.semester_id},onResponseError({response:F}){f.value=F._data.errors}}),{accessToken:e,userData:u,sekolah:g,semester:h,userAbility:i,roles:T}=s;w.value=u.name,m("userAbilityRules").value=i,q.update(i),m("userData").value=u,m("accessToken").value=e,m("sekolah").value=g,m("semester").value=h,m("roles").value=T,m("profilePhotoPath").value=u.profile_photo_path,y.value=T.join(", "),await Z(()=>{j.replace(k.query.to?String(k.query.to):"/").then(()=>{B()})})}catch(s){console.error(s)}},$=()=>{var s;(s=b.value)==null||s.validate().then(({valid:e})=>{e&&U()})},x=n(!1),S=n([]);O(async()=>{await M()});const M=async()=>{try{let e=(await le(ie("/auth/semester"))).data.value;S.value=e.semester,l.value.semester_id=e.semester_id,x.value=e.allowRegister}catch(s){console.error(s)}};return(s,e)=>{const u=ae,g=ee,h=Y("RouterLink");return C(),E(G,null,[o("a",fe,[o("div",ge,[o("img",{src:a(d).app.logo,height:"24"},null,8,he),o("h1",Ve,V(a(d).app.title),1)])]),t(D,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:r(()=>[t(p,{md:"8",class:"d-none d-md-flex"},{default:r(()=>[o("div",_e,[o("div",ve,[t(ne,{"max-width":"613",src:a(L),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),o("img",{class:"auth-footer-mask flip-in-rtl",src:a(N),alt:"auth-footer-mask",height:"280",width:"100"},null,8,be)])]),_:1}),t(p,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:r(()=>[t(me,{flat:"","max-width":500,class:"mt-sm-0 pa-6"},{default:r(()=>[t(v,{class:"text-center"},{default:r(()=>[o("h1",ke,[o("img",{src:a(d).app.logo,height:"28"},null,8,ye),_(" "+V(a(d).app.title),1)]),o("p",null,"Versi "+V(a(d).app.version),1),e[5]||(e[5]=o("p",{class:"mb-0"},"Silahkan login untuk dapat mengakses Aplikasi",-1))]),_:1}),t(v,null,{default:r(()=>[t(ue,{ref_key:"refVForm",ref:b,onSubmit:J($,["prevent"])},{default:r(()=>[t(D,null,{default:r(()=>[t(p,{cols:"12"},{default:r(()=>[t(u,{modelValue:a(l).email,"onUpdate:modelValue":e[0]||(e[0]=i=>a(l).email=i),"error-messages":a(f).email,autofocus:"",label:"Email/NUPTK/NISN",placeholder:"Email/NUPTK/NISN",rules:["requiredValidator"in s?s.requiredValidator:a(I)]},null,8,["modelValue","error-messages","rules"])]),_:1}),t(p,{cols:"12"},{default:r(()=>[t(u,{modelValue:a(l).password,"onUpdate:modelValue":e[1]||(e[1]=i=>a(l).password=i),"error-messages":a(f).password,label:"Password",placeholder:"············",type:a(c)?"text":"password",autocomplete:"password","append-inner-icon":a(c)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[2]||(e[2]=i=>c.value=!a(c)),rules:["requiredValidator"in s?s.requiredValidator:a(I)]},null,8,["modelValue","error-messages","type","append-inner-icon","rules"])]),_:1}),t(p,{cols:"12"},{default:r(()=>[t(g,{items:a(S),"item-title":"nama","item-value":"semester_id",label:"Tahun Pelajaran",modelValue:a(l).semester_id,"onUpdate:modelValue":e[3]||(e[3]=i=>a(l).semester_id=i),placeholder:"Select Item"},null,8,["items","modelValue"]),o("div",we,[t(de,{modelValue:a(l).remember,"onUpdate:modelValue":e[4]||(e[4]=i=>a(l).remember=i),label:"Simpan Login"},null,8,["modelValue"]),e[6]||(e[6]=o("a",{class:"text-primary",href:"javascript:void(0)"}," Lupa Password? ",-1))]),t(X,{block:"",type:"submit"},{default:r(()=>e[7]||(e[7]=[_(" Login ")])),_:1})]),_:1}),a(x)?(C(),Q(p,{key:0,cols:"12",class:"text-center"},{default:r(()=>[e[9]||(e[9]=o("span",null,"Pengguna Baru?",-1)),t(h,{class:"text-primary ms-1",to:{name:"register"}},{default:r(()=>e[8]||(e[8]=[_(" Register Disini ")])),_:1})]),_:1})):W("",!0)]),_:1})]),_:1},512)]),_:1}),t(v)]),_:1})]),_:1})]),_:1})],64)}}};export{Ze as default};
