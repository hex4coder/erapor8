import{_ as C}from"./AppTextField-D2LXjmv0.js";import{ay as N,H as S,r as d,G as U,c as D,b as e,e as a,o as V,f as w,l as K,m as t,d as p,t as x,v as y,ax as T,a0 as A,a1 as E,ab as $,ac as j}from"./main-BmaFLECC.js";import{u as I}from"./useApi-aDZ_p2JA.js";import{c as H}from"./createUrl-CavU1t8i.js";import{$ as L}from"./api-CmLymv6O.js";import{V as m,a as s}from"./VRow-C3UxGzeT.js";import{V as M}from"./VCard-DPBtMZW7.js";import{V as c}from"./VCardText-D2uK2Y8d.js";import{V as R}from"./VDivider-BN4YXaja.js";import{V as q}from"./VAlert-BxLHTpLf.js";import{V as z}from"./VForm-DpvbJd19.js";import{V as G}from"./VImg-60m1FPF8.js";import{V as O}from"./VFileInput-CYeci0Gp.js";import"./VLabel-Dun9QuG8.js";import"./VTextField-DU5I-02O.js";import"./forwardRefs-DWGaNmQL.js";import"./index-9rIf2CJL.js";/* empty css              */import"./VAvatar-DzKqRnSB.js";import"./VChip-DASL0bCx.js";const ve={__name:"profile",setup(J){N({title:`Profil Pengguna | ${S.app.title}`});const h=d(!0),b=d(),f=d(),_=d(!1),g=d({color:"",title:"",text:""}),l=d({name:null,email:null,password:null,password_confirmation:null,photo:null});U(async()=>{await k()});const k=async()=>{try{let o=(await I(H("/auth/user"))).data.value;l.value.name=o.name,l.value.email=o.email,f.value=o.profile_photo_path}catch(r){console.error(r)}finally{h.value=!1}},P=()=>{var r;(r=b.value)==null||r.validate().then(({valid:o})=>{o&&B()})},i=d({name:void 0,email:void 0,password:void 0,password_confirmation:void 0,photo:void 0}),F=j("erapor"),B=async()=>{i.value={name:void 0,email:void 0,password:void 0,password_confirmation:void 0,photo:void 0};const r=new FormData;r.append("data","user"),r.append("name",l.value.name?l.value.name:""),r.append("email",l.value.email?l.value.email:""),r.append("password",l.value.password?l.value.password:""),r.append("password_confirmation",l.value.password_confirmation?l.value.password_confirmation:""),r.append("photo",l.value.photo?l.value.photo:""),await L("/auth/user",{method:"POST",body:r,onResponse({request:o,response:u,options:n}){let v=u._data;if(v.errors)i.value=v.errors;else{_.value=!0,g.value=v,l.value.photo=null,l.value.password=null,l.value.password_confirmation=null,f.value=v.user.profile_photo_path,$("profilePhotoPath").value=f.value;try{F.emit(f.value)}catch{}setTimeout(()=>{_.value=!1},5e3)}}})};return(r,o)=>{const u=C;return V(),D("div",null,[e(m,null,{default:a(()=>[e(s,{cols:"12"},{default:a(()=>[e(M,{title:"Informasi Profil Pengguna"},{append:a(()=>o[5]||(o[5]=[p("span",{class:"text-disabled text-subtitle-2"},"Perbaharui informasi profil dan alamat email akun Anda jika diperlukan.",-1)])),default:a(()=>[e(c),e(R),t(_)?(V(),w(c,{key:0},{default:a(()=>[e(q,{border:"bottom",color:t(g).color,variant:"tonal"},{default:a(()=>[p("strong",null,y(t(g).title),1),x(" "+y(t(g).text),1)]),_:1},8,["color"])]),_:1})):K("",!0),t(h)?(V(),w(c,{key:1,class:"text-center"},{default:a(()=>[e(T,{size:60,indeterminate:"",color:"error"})]),_:1})):(V(),w(c,{key:2},{default:a(()=>[e(z,{ref_key:"refVForm",ref:b,onSubmit:A(P,["prevent"])},{default:a(()=>[e(m,null,{default:a(()=>[e(s,{cols:"8"},{default:a(()=>[e(m,null,{default:a(()=>[e(s,{cols:"12"},{default:a(()=>[e(m,{"no-gutters":""},{default:a(()=>[e(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>o[6]||(o[6]=[p("label",{class:"v-label text-body-2 text-high-emphasis",for:"name"},"Nama Lengkap",-1)])),_:1}),e(s,{cols:"12",md:"9"},{default:a(()=>[e(u,{id:"name",modelValue:t(l).name,"onUpdate:modelValue":o[0]||(o[0]=n=>t(l).name=n),placeholder:"Nama Lengkap","persistent-placeholder":"","error-messages":t(i).name},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(s,{cols:"12"},{default:a(()=>[e(m,{"no-gutters":""},{default:a(()=>[e(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>o[7]||(o[7]=[p("label",{class:"v-label text-body-2 text-high-emphasis",for:"email"},"Email",-1)])),_:1}),e(s,{cols:"12",md:"9"},{default:a(()=>[e(u,{id:"email",type:"email",modelValue:t(l).email,"onUpdate:modelValue":o[1]||(o[1]=n=>t(l).email=n),placeholder:"Email","persistent-placeholder":"","error-messages":t(i).email},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(s,{cols:"12"},{default:a(()=>[e(m,{"no-gutters":""},{default:a(()=>[e(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>o[8]||(o[8]=[p("label",{class:"v-label text-body-2 text-high-emphasis",for:"password"},"Kata Sandi Baru",-1)])),_:1}),e(s,{cols:"12",md:"9"},{default:a(()=>[e(u,{id:"password",type:"password",modelValue:t(l).password,"onUpdate:modelValue":o[2]||(o[2]=n=>t(l).password=n),placeholder:"Kosongkan jika tidak ingin mengganti kata sandi","persistent-placeholder":"","error-messages":t(i).password},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(s,{cols:"12"},{default:a(()=>[e(m,{"no-gutters":""},{default:a(()=>[e(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>o[9]||(o[9]=[p("label",{class:"v-label text-body-2 text-high-emphasis",for:"password_confirmation"},"Konfirmasi Kata Sandi",-1)])),_:1}),e(s,{cols:"12",md:"9"},{default:a(()=>[e(u,{id:"password_confirmation",type:"password",modelValue:t(l).password_confirmation,"onUpdate:modelValue":o[3]||(o[3]=n=>t(l).password_confirmation=n),placeholder:"Kosongkan jika tidak ingin mengganti kata sandi","persistent-placeholder":"","error-messages":t(i).password_confirmation},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(s,{"offset-md":"3",cols:"12",md:"9",class:"d-flex gap-4"},{default:a(()=>[e(E,{type:"submit"},{default:a(()=>o[10]||(o[10]=[x(" Submit ")])),_:1})]),_:1})]),_:1})]),_:1}),e(s,{cols:"4",class:"text-center"},{default:a(()=>[e(G,{alt:t(l).name,src:t(f),cover:"",class:"mx-auto mb-10",width:"250px"},null,8,["alt","src"]),e(O,{modelValue:t(l).photo,"onUpdate:modelValue":o[4]||(o[4]=n=>t(l).photo=n),"error-messages":t(i).photo,accept:"image/*",label:"Unggah Foto Profil"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1},512)]),_:1})),e(c)]),_:1})]),_:1})]),_:1})])}}};export{ve as default};
