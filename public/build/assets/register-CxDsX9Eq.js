import{r as V,e as j}from"./validators-BHkKs9Dp.js";import{ay as F,H as m,aW as L,r as c,az as x,j as E,c as O,b as s,f as R,e as t,a as $,m as e,F as H,o as k,d as o,v as b,ax as U,t as w,a0 as z,a1 as G}from"./main-BmaFLECC.js";import{_ as K}from"./AppTextField-D2LXjmv0.js";import{a as T,l as S}from"./index-DmeuT8qN.js";import{u as q,a as W,b as Z}from"./misc-mask-light-DFRoxJPE.js";import{u as J}from"./useApi-aDZ_p2JA.js";import{c as Q}from"./createUrl-CavU1t8i.js";import{$ as X}from"./api-CmLymv6O.js";import{V as v,a as u}from"./VRow-C3UxGzeT.js";import{V as Y}from"./VImg-60m1FPF8.js";import{V as ee}from"./VCard-DPBtMZW7.js";import{V as B}from"./VCardText-D2uK2Y8d.js";import{V as ae}from"./VForm-DpvbJd19.js";import"./VLabel-Dun9QuG8.js";import"./VTextField-DU5I-02O.js";import"./forwardRefs-DWGaNmQL.js";import"./index-9rIf2CJL.js";/* empty css              */import"./VAvatar-DzKqRnSB.js";const se="/build/assets/auth-v2-register-illustration-bordered-dark-DATv6AkE.png",re="/build/assets/auth-v2-register-illustration-bordered-light-efkpyIZr.png",te={class:"auth-logo d-flex align-center gap-x-3"},oe=["src"],le={class:"auth-title"},ie={class:"position-relative bg-background w-100 me-0"},ne={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"100px"}},de=["src"],ue={class:"text-h2 mb-1"},me=["src"],De={__name:"register",setup(pe){const C=q(T,T,re,se,!0),I=q(Z,W),_=E();F({title:`Register | ${m.app.title}`}),L(async()=>{await A()});const g=c(!0),A=async()=>{try{let a=(await J(Q("/auth/allow-register"))).data.value;a.sekolah?a.allowRegister?g.value=!1:await x(()=>{_.replace("/404")}):g.value=!1}catch(r){console.error(r)}},y=c(),l=c({npsn:"",email:"",password:""}),n=c({npsn:void 0,email:void 0,password:void 0}),f=c(!1),D=()=>{S(`<strong>Registrasi Berhasil</strong>
    <br>Anda telah berhasil register. Sekarang Anda dapat mulai berselancar di Aplikasi e-Rapor SMK!`,{closeOnClick:!1,autoClose:5e3,position:S.POSITION.TOP_RIGHT,dangerouslyHTMLString:!0})},N=async()=>{var r,a,p;try{const d=await X("/auth/register",{method:"POST",body:{npsn:l.value.npsn,email:l.value.email,password:l.value.password},onResponseError({response:M}){n.value=M._data.errors}}),{error:i,errors:h,message:ce}=d;i?(n.value.npsn=(r=h.npsn)==null?void 0:r.join(", "),n.value.email=(a=h.email)==null?void 0:a.join(", "),n.value.password=(p=h.password)==null?void 0:p.join(", ")):await x(()=>{_.replace("/login").then(()=>{D()})})}catch(d){console.error(d)}},P=()=>{var r;(r=y.value)==null||r.validate().then(({valid:a})=>{a&&N()})};return(r,a)=>{const p=$("RouterLink"),d=K;return k(),O(H,null,[s(p,{to:"/"},{default:t(()=>[o("div",te,[o("img",{src:e(m).app.logo,height:"24"},null,8,oe),o("h1",le,b(e(m).app.title),1)])]),_:1}),e(g)?(k(),R(v,{key:0,"no-gutters":"",class:"auth-wrapper bg-surface text-center"},{default:t(()=>[s(u,{cols:"12"},{default:t(()=>[s(U,{size:60,indeterminate:"",color:"error",class:"mt-16"})]),_:1})]),_:1})):(k(),R(v,{key:1,"no-gutters":"",class:"auth-wrapper bg-surface"},{default:t(()=>[s(u,{md:"8",class:"d-none d-md-flex"},{default:t(()=>[o("div",ie,[o("div",ne,[s(Y,{"max-width":"500",src:e(C),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),o("img",{class:"auth-footer-mask",src:e(I),alt:"auth-footer-mask",height:"280",width:"100"},null,8,de)])]),_:1}),s(u,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:t(()=>[s(ee,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:t(()=>[s(B,{class:"text-center"},{default:t(()=>[o("h1",ue,[o("img",{src:e(m).app.logo,height:"28"},null,8,me),w(" "+b(e(m).app.title),1)]),o("p",null,"Versi "+b(e(m).app.version),1),a[4]||(a[4]=o("p",{class:"mb-0"},"Silahkan register untuk dapat mengakses Aplikasi",-1))]),_:1}),s(B,null,{default:t(()=>[s(e(ae),{ref_key:"refVForm",ref:y,onSubmit:z(P,["prevent"])},{default:t(()=>[s(v,null,{default:t(()=>[s(u,{cols:"12"},{default:t(()=>[s(d,{modelValue:e(l).npsn,"onUpdate:modelValue":a[0]||(a[0]=i=>e(l).npsn=i),rules:["requiredValidator"in r?r.requiredValidator:e(V)],autofocus:"",label:"NPSN",placeholder:"NPSN","error-messages":e(n).npsn,required:""},null,8,["modelValue","rules","error-messages"])]),_:1}),s(u,{cols:"12"},{default:t(()=>[s(d,{modelValue:e(l).email,"onUpdate:modelValue":a[1]||(a[1]=i=>e(l).email=i),rules:["requiredValidator"in r?r.requiredValidator:e(V),"emailValidator"in r?r.emailValidator:e(j)],label:"Email",type:"email",placeholder:"Email Admin Dapodik","error-messages":e(n).email,required:""},null,8,["modelValue","rules","error-messages"])]),_:1}),s(u,{cols:"12"},{default:t(()=>[s(d,{modelValue:e(l).password,"onUpdate:modelValue":a[2]||(a[2]=i=>e(l).password=i),rules:["requiredValidator"in r?r.requiredValidator:e(V)],label:"Password",placeholder:"············",type:e(f)?"text":"password",autocomplete:"password","append-inner-icon":e(f)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[3]||(a[3]=i=>f.value=!e(f)),"error-messages":e(n).password,required:""},null,8,["modelValue","rules","type","append-inner-icon","error-messages"]),s(G,{block:"",type:"submit",class:"mt-6"},{default:t(()=>a[5]||(a[5]=[w(" Register ")])),_:1})]),_:1}),s(u,{cols:"12",class:"text-center text-base"},{default:t(()=>[a[7]||(a[7]=o("span",{class:"d-inline-block"},"Telah terdaftar?",-1)),s(p,{class:"text-primary ms-1 d-inline-block",to:{name:"login"}},{default:t(()=>a[6]||(a[6]=[w(" Login Disini ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}))],64)}}};export{De as default};
